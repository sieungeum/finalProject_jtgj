<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jtgj.finalProject.admin.dao.IAdminDAO">

<select id="getUserList" resultType="com.jtgj.finalProject.user.dto.UserDTO">

		SELECT
			  user_id
			, user_name
			, user_email
			, user_date
			, user_account
			, user_rank 
		FROM 
			users
		WHERE 1=1
 
</select>

<update id="userDo" parameterType="com.jtgj.finalProject.user.dto.UserDTO">
	    UPDATE 
	        users
	    SET
	    	user_rank = 'K'                      
	    WHERE 
	        user_id = #{userId} 
	        AND user_name = #{userName}
	</update>
	
<update id="userProDo" parameterType="com.jtgj.finalProject.user.dto.UserDTO">
	    UPDATE 
	        users
	    SET
	    	user_rank = 'M'                      
	    WHERE 
	        user_id = #{userId} 
	        AND user_name = #{userName}
	</update>
	
<update id="userLDo" parameterType="com.jtgj.finalProject.user.dto.UserDTO">
	    UPDATE 
	        users
	    SET   
	    	user_rank = 'L'                      
	    WHERE 
	        user_id = #{userId} 
	        AND user_name = #{userName}
	</update>

<update id="userDelDo" parameterType="com.jtgj.finalProject.user.dto.UserDTO">
	    UPDATE 
	        users
	    SET
	    	user_rank = 'N'                      
	    WHERE 
	        user_id = #{userId} 
	        AND user_name = #{userName}
	</update>
	
<update id="faqAstDo" parameterType="com.jtgj.finalProject.faq.dto.FaqDTO">
	    UPDATE 
	        faqs
	    SET
	    	faq_ast = 'Y'                      
	    WHERE 
	        faq_no = #{faqNo} 
	</update>
	
	<update id="faqAstDelDo" parameterType="com.jtgj.finalProject.faq.dto.FaqDTO">
	    UPDATE 
	        faqs
	    SET
	    	faq_ast = 'N'                      
	    WHERE 
	        faq_no = #{faqNo} 
	</update>
	

	
	
<select id="getFaqList" resultType="com.jtgj.finalProject.faq.dto.FaqDTO">

				SELECT
					a.faq_no,
					a.user_id,
					a.faq_title,
					a.faq_count,
					b.user_name,
					TO_CHAR(a.faq_date, 'MM.dd') AS faq_date,
					a.faq_ast
				FROM 
					faqs a
					, users b
				WHERE 1=1
					AND a.user_id = b.user_id
				
				ORDER BY faq_no DESC
			

</select>
 
<select id="getMater" parameterType="int" resultType="com.jtgj.finalProject.estimate.dto.EstimateDTO">
    SELECT * 
    FROM building_materials 
    WHERE mater_no = #{materNo}
    AND ROWNUM = 1
</select>

	<update id="editMater" parameterType="com.jtgj.finalProject.estimate.dto.EstimateDTO">
		UPDATE
			building_materials
		SET
			  mater_name = #{materName}
			, mater_category = #{materCategory}
			, mater_gas_kg = #{materGasKg}
			, mater_img = #{materImg}
			, mater_price = #{materPrice}
			, mater_durability = #{materDurability}
			, mater_info = #{materInfo}
			, mater_classify = #{materClassify}
		WHERE 1=1
			AND mater_no = #{materNo}
	</update>

<insert id="writeMater" parameterType="com.jtgj.finalProject.estimate.dto.EstimateDTO">
    INSERT INTO building_materials (
        mater_no,
        mater_name,
        mater_category,
        mater_gas_kg,
        mater_img,
        mater_price,
        mater_durability,
        mater_info,
        mater_classify
    ) VALUES (
        (SELECT NVL(MAX(mater_no), 0) + 1 FROM building_materials),
        #{materName},
        #{materCategory},
        #{materGasKg},
        #{materImg, jdbcType=VARCHAR},
        #{materPrice},
        #{materDurability},
        #{materInfo},
        #{materClassify}
    )
</insert>


<select id="getMaterNo" resultType="int">
		SELECT
			COUNT(*) + 1
		FROM
			building_materials
</select>
	




</mapper>