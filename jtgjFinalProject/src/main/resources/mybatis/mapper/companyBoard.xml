<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jtgj.finalProject.companyBoard.dao.ICompanyBoardDAO">
	<select id="getCompanyBoardList" resultType="com.jtgj.finalProject.companyBoard.dto.CompanyBoardDTO">
	    SELECT 
	        a.cp_board_no,
	        a.cp_board_intro,
	        a.user_id,
	        b.cp_ceo_name,
	        c.user_name,
	        a.cp_board_area,
	        a.cp_board_date,
	        a.cp_board_reper_img,
	        a.cp_board_del_yn
	    FROM 
	        company_board a, company_info b, users c
	    WHERE 1=1
	        AND a.cp_board_del_yn = 'N'
	        AND a.user_id = b.user_id
	        AND a.user_id = c.user_id
	</select>
	
	<insert id="writeCompanyBoard" parameterType="com.jtgj.finalProject.companyBoard.dto.CompanyBoardDTO">
		INSERT INTO company_board(
			cp_board_no, 				
		    cp_board_intro,		
		    user_id ,
		    user_name,				
		    cp_board_content,		
		    cp_board_area,			
		    cp_board_date,				
		    cp_board_reper_img,	
		    cp_board_del_yn 		
		) VALUES (
			(SELECT COUNT(*)+1 FROM company_board),
			#{cpBoardIntro},
			#{userId},
			#{userName},
			#{cpBoardContent},
			#{cpBoardArea},
			SYSDATE,
			#{cpBoardReperImg},
			'N'
		)
	</insert>
	
	<select id="checkIfPosted" resultType="int">
	    SELECT COUNT(*) 
	    FROM company_board 
	    WHERE user_id = #{userId}
	</select>
	
</mapper>